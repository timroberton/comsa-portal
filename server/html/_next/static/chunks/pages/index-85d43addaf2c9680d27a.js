(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8917:function(e,t,a){"use strict";a.d(t,{kP:function(){return r}});let n=e=>crypto.getRandomValues(new Uint8Array(e)),r=(e,t)=>((e,t,a)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,r=-~(1.6*n*t/e.length);return()=>{let s="";for(;;){let i=a(r),l=r;for(;l--;)if(s+=e[i[l]&n]||"",s.length===t)return s}}})(e,t,n)},2688:function(e,t,a){"use strict";a.d(t,{c:function(){return f}});var n=a(809),r=a.n(n),s=a(5893),i=a(1385),l=a(2447),c=a(7294),o=a(8813),u=a(8212),d=a(3384),f=function(e){var t=(0,c.useState)(e.initialName),a=t[0],n=t[1],f=(0,c.useState)(e.initialLanguage),p=f[0],h=f[1],m=(0,c.useState)(e.initialTopic),x=m[0],v=m[1],y=(0,c.useState)(e.initialTags.join(", ")),g=y[0],j=y[1],w=(0,c.useState)(e.initialScheduled),L=w[0],N=w[1],k=(0,c.useState)(!1),b=k[0],C=k[1];function A(){return R.apply(this,arguments)}function R(){return(R=(0,l.Z)(r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==a.trim()){t.next=3;break}return window.alert("You must enter a name for the analysis"),t.abrupt("return");case 3:return C(!0),n=g.trim().split(",").map((function(e){return e.trim()})).filter((function(e){return e})),t.next=7,e.save(a.trim(),p,x.trim(),n,L);case 7:e.cancel();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(){return(M=(0,l.Z)(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.attemptDeleteAnalysis){t.next=2;break}return t.abrupt("return");case 2:return C(!0),t.next=5,e.attemptDeleteAnalysis();case 5:e.cancel();case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,s.jsx)(u.u_,{cancel:e.cancel,minWidth:600,children:b?(0,s.jsx)("div",{className:"",children:"Saving..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"ui-form-subheader",children:"Title"}),(0,s.jsx)(d.u3,{value:a,onChange:n,autoFocus:!0}),(0,s.jsx)("div",{className:"mt-4 ui-form-subheader",children:"Statistical package"}),(0,s.jsx)(d.Cj,{value:p,onChange:function(e){return h(e)},options:[{value:o.$v.Stata,text:"Stata"},{value:o.$v.R,text:"R"}]}),(0,s.jsx)("div",{className:"mt-4 ui-form-subheader",children:"Topic"}),(0,s.jsx)(d.Cj,{value:x,onChange:function(e){return v(String(e))},options:[{value:"",text:"No topic"}].concat((0,i.Z)(e.topics.map((function(e){return{value:e.id,text:e.label}}))))}),(0,s.jsx)("div",{className:"mt-4 ui-form-subheader",children:"Tags (comma separated)"}),(0,s.jsx)(d.u3,{value:g,onChange:j}),(0,s.jsx)("div",{className:"mt-4 ui-form-subheader",children:"Scheduler"}),(0,s.jsx)(d.mA,{rootId:"schedule",label:"Include this analysis in daily scheduled run",checked:L,onChange:function(e){return N(e)}}),e.isNewAnalysis?(0,s.jsxs)(u.nK,{children:[(0,s.jsx)(d.y3,{label:"Create new analysis",onClick:A,color:d.Wo.Green}),(0,s.jsx)(d.y3,{label:"Cancel",onClick:e.cancel,color:d.Wo.Gray,marginLeft:!0})]}):(0,s.jsxs)(u.nK,{children:[(0,s.jsx)(d.y3,{label:"Done",onClick:A,color:d.Wo.Blue}),(0,s.jsx)(d.y3,{label:"Cancel",onClick:e.cancel,color:d.Wo.Gray,marginLeft:!0}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)(d.y3,{label:"Delete this analysis",onClick:function(){return M.apply(this,arguments)},color:d.Wo.Red,marginLeft:!0})]})]})})}},2167:function(e,t,a){"use strict";var n=a(3848),r=a(9448);t.default=void 0;var s=r(a(7294)),i=a(9414),l=a(4651),c=a(7426),o={};function u(e,t,a,n){if(e&&(0,i.isLocalURL)(t)){e.prefetch(t,a,n).catch((function(e){0}));var r=n&&"undefined"!==typeof n.locale?n.locale:e&&e.locale;o[t+"%"+a+(r?"%"+r:"")]=!0}}var d=function(e){var t,a=!1!==e.prefetch,r=(0,l.useRouter)(),d=s.default.useMemo((function(){var t=(0,i.resolveHref)(r,e.href,!0),a=n(t,2),s=a[0],l=a[1];return{href:s,as:e.as?(0,i.resolveHref)(r,e.as):l||s}}),[r,e.href,e.as]),f=d.href,p=d.as,h=e.children,m=e.replace,x=e.shallow,v=e.scroll,y=e.locale;"string"===typeof h&&(h=s.default.createElement("a",null,h));var g=(t=s.Children.only(h))&&"object"===typeof t&&t.ref,j=(0,c.useIntersection)({rootMargin:"200px"}),w=n(j,2),L=w[0],N=w[1],k=s.default.useCallback((function(e){L(e),g&&("function"===typeof g?g(e):"object"===typeof g&&(g.current=e))}),[g,L]);(0,s.useEffect)((function(){var e=N&&a&&(0,i.isLocalURL)(f),t="undefined"!==typeof y?y:r&&r.locale,n=o[f+"%"+p+(t?"%"+t:"")];e&&!n&&u(r,f,p,{locale:t})}),[p,f,N,y,a,r]);var b={ref:k,onClick:function(e){t.props&&"function"===typeof t.props.onClick&&t.props.onClick(e),e.defaultPrevented||function(e,t,a,n,r,s,l,c){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,i.isLocalURL)(a))&&(e.preventDefault(),null==l&&n.indexOf("#")>=0&&(l=!1),t[r?"replace":"push"](a,n,{shallow:s,locale:c,scroll:l}))}(e,r,f,p,m,x,v,y)},onMouseEnter:function(e){(0,i.isLocalURL)(f)&&(t.props&&"function"===typeof t.props.onMouseEnter&&t.props.onMouseEnter(e),u(r,f,p,{priority:!0}))}};if(e.passHref||"a"===t.type&&!("href"in t.props)){var C="undefined"!==typeof y?y:r&&r.locale,A=r&&r.isLocaleDomain&&(0,i.getDomainLocale)(p,C,r&&r.locales,r&&r.domainLocales);b.href=A||(0,i.addBasePath)((0,i.addLocale)(p,C,r&&r.defaultLocale))}return s.default.cloneElement(t,b)};t.default=d},7426:function(e,t,a){"use strict";var n=a(3848);t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,a=e.disabled||!i,c=(0,r.useRef)(),o=(0,r.useState)(!1),u=n(o,2),d=u[0],f=u[1],p=(0,r.useCallback)((function(e){c.current&&(c.current(),c.current=void 0),a||d||e&&e.tagName&&(c.current=function(e,t,a){var n=function(e){var t=e.rootMargin||"",a=l.get(t);if(a)return a;var n=new Map,r=new IntersectionObserver((function(e){e.forEach((function(e){var t=n.get(e.target),a=e.isIntersecting||e.intersectionRatio>0;t&&a&&t(a)}))}),e);return l.set(t,a={id:t,observer:r,elements:n}),a}(a),r=n.id,s=n.observer,i=n.elements;return i.set(e,t),s.observe(e),function(){i.delete(e),s.unobserve(e),0===i.size&&(s.disconnect(),l.delete(r))}}(e,(function(e){return e&&f(e)}),{rootMargin:t}))}),[a,t,d]);return(0,r.useEffect)((function(){if(!i&&!d){var e=(0,s.requestIdleCallback)((function(){return f(!0)}));return function(){return(0,s.cancelIdleCallback)(e)}}}),[d]),[p,d]};var r=a(7294),s=a(3447),i="undefined"!==typeof IntersectionObserver;var l=new Map},2562:function(e,t,a){"use strict";a.r(t);var n=a(809),r=a.n(n),s=a(5893),i=a(1385),l=a(2447),c=a(9008),o=a(1664),u=a(5876),d=a(8080),f=a(6049),p=a(8486),h=a(7294),m=a(2688),x=a(1203),v=a(8813),y=a(3384),g=a(622);function j(e){switch(e){case v.Aq.Pending:return(0,s.jsx)("svg",{className:"flex-shrink-0 w-5 h-5 text-orange-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16z",clipRule:"evenodd"})});case v.Aq.Success:return(0,s.jsx)("svg",{className:"flex-shrink-0 w-5 h-5 text-green-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case v.Aq.Failure:return(0,s.jsx)("svg",{className:"flex-shrink-0 w-5 h-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}return(0,s.jsx)("svg",{className:"flex-shrink-0 w-5 h-5 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16z",clipRule:"evenodd"})})}t.default=function(e){var t=e.uu.loginState===d.z.LoggedIn&&e.uu.user.canEdit,a=(0,h.useState)(!1),n=a[0],w=a[1];function L(){return(L=(0,l.Z)(r().mark((function t(a,n,s,i,l){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ua.createNewAnalysis(a,n,s,i,l);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var N=(0,h.useMemo)((function(){return e.ua.analyses.filter((function(t){return""===e.uui.searchText.trim()||t.metadata.name.toLowerCase().includes(e.uui.searchText.trim().toLowerCase())})).filter((function(t){return""===e.uui.selectedTopic||t.metadata.topic===e.uui.selectedTopic})).filter((function(t){return 0===e.uui.selectedTags.length||t.metadata.tags.some((function(t){return e.uui.selectedTags.includes(t)}))}))}),[e.ua.analyses,e.uui.selectedTags,e.uui.selectedTopic,e.uui.searchText]),k=(0,h.useMemo)((function(){var t=(0,i.Z)(N);switch(e.uui.filterPropertyAnalyses){case p.Lw.Name:t.sort((function(e,t){return e.metadata.name.toLowerCase()>t.metadata.name.toLowerCase()?1:-1}));break;case p.Lw.Topic:t.sort((function(t,a){var n=e.ut.topicMap[t.metadata.topic],r=e.ut.topicMap[a.metadata.topic];return(n?n.toLowerCase():"zzzzzz")>(r?r.toLowerCase():"zzzzzz")?1:-1}));break;case p.Lw.Tags:t.sort((function(e,t){var a=[e.metadata.language===v.$v.R?"R":"Stata"].concat((0,i.Z)(e.metadata.tags)).join(", "),n=[t.metadata.language===v.$v.R?"R":"Stata"].concat((0,i.Z)(t.metadata.tags)).join(", ");return a.toLowerCase()>n.toLowerCase()?-1:1}));break;case p.Lw.LastModified:t.sort((function(e,t){return e.metadata.lastModifiedAt<t.metadata.lastModifiedAt?1:-1}));break;case p.Lw.Scheduled:t.sort((function(e,t){return(0===e.order?999999:e.order)-(0===t.order?999999:t.order)}));break;case p.Lw.LastRun:t.sort((function(e,t){return e.metadata.lastRunAt<t.metadata.lastRunAt?1:-1}))}return t}),[N,e.uui.filterPropertyAnalyses,e.ut.topicMap]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.default,{children:[(0,s.jsx)("title",{children:"Analysis Portal"}),(0,s.jsx)("link",{rel:"stylesheet",type:"text/css",href:"/roboto.css"})]}),(0,s.jsxs)(u.L,{uu:e.uu,page:"analyses",title:"Analyses",buttons:t?[{label:"Refresh analyses",onClick:e.ua.refreshAnalyses,icon:f.DuK,color:y.Wo.LightGray},{label:"New analysis",onClick:function(){return w(!0)},icon:f.pOD}]:[{label:"Refresh analyses",onClick:e.ua.refreshAnalyses,icon:f.DuK,color:y.Wo.LightGray}],children:[e.ua.loading?(0,s.jsx)("div",{className:"",children:"Loading..."}):(0,s.jsx)(g.V,{filterControls:(0,s.jsx)(x.C,{canEdit:t,ua:e.ua,uui:e.uui,ut:e.ut,nTotal:e.ua.analyses.length,nFiltered:k.length}),children:0===k.length?(0,s.jsx)("div",{className:"py-2 text-sm leading-5 text-gray-400",children:"No matching analyses"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("li",{className:"grid grid-cols-12 gap-2 py-2 text-sm font-bold leading-5",children:[(0,s.jsxs)("div",{className:"col-span-4 truncate cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.Name)},children:["Analysis",e.uui.filterPropertyAnalyses===p.Lw.Name&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]}),(0,s.jsxs)("div",{className:"col-span-2 truncate cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.Topic)},children:["Topic",e.uui.filterPropertyAnalyses===p.Lw.Topic&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]}),(0,s.jsxs)("div",{className:"col-span-1 truncate cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.Tags)},children:["Tags",e.uui.filterPropertyAnalyses===p.Lw.Tags&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]}),(0,s.jsxs)("div",{className:"col-span-2 truncate cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.LastModified)},children:["Last modified",e.uui.filterPropertyAnalyses===p.Lw.LastModified&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]}),(0,s.jsxs)("div",{className:"flex items-center col-span-1 cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.Scheduled)},children:[(0,s.jsx)("span",{className:"flex-shrink inline-block truncate",children:"Scheduled"}),e.uui.filterPropertyAnalyses===p.Lw.Scheduled&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]}),(0,s.jsxs)("div",{className:"col-span-2 truncate cursor-pointer hover:underline",onClick:function(){return e.uui.updateFilterPropertyAnalyses(p.Lw.LastRun)},children:["Last run",e.uui.filterPropertyAnalyses===p.Lw.LastRun&&(0,s.jsx)(f.veu,{className:"inline-block w-3 h-3 ml-1"})]})]}),k.map((function(t,a){return(0,s.jsxs)("li",{className:"border-t border-gray-200 py-2 grid grid-cols-12 gap-2 text-sm leading-5 select-text",children:[(0,s.jsx)("div",{className:"col-span-4 leading-4",children:(0,s.jsx)(o.default,{href:"/analysis/?id=".concat(t.id),children:(0,s.jsx)("a",{className:"ui-link",children:t.metadata.name})},t.id)}),(0,s.jsx)("div",{className:"col-span-2 text-xs",children:e.ut.topicMap[t.metadata.topic]||(0,s.jsx)("span",{className:"text-gray-400",children:"No topic"})}),(0,s.jsx)("div",{className:"col-span-1 text-xs",children:[t.metadata.language===v.$v.R?"R":"Stata"].concat((0,i.Z)(t.metadata.tags)).join(", ")}),(0,s.jsxs)("div",{className:"col-span-2 text-xs",children:[(0,s.jsx)("div",{className:"truncate",children:new Date(t.metadata.lastModifiedAt).toLocaleString()}),(0,s.jsx)("div",{className:"truncate",children:t.metadata.lastModifiedBy})]}),(0,s.jsx)("div",{className:"col-span-1 text-xs",children:t.metadata.scheduled?"Yes (".concat(0==t.order?"!!":t.order,")"):(0,s.jsx)("span",{className:"text-gray-400",children:"No"})}),(0,s.jsx)("div",{className:"col-span-2 text-xs",children:(0,s.jsxs)("div",{className:"flex w-full gap-x-2",children:[(0,s.jsx)("div",{className:"flex-none",children:j(t.metadata.lastStatus)}),(0,s.jsxs)("div",{className:"flex-1 w-0",children:[(0,s.jsx)("div",{className:"w-full truncate",children:new Date(t.metadata.lastRunAt).toLocaleString()}),(0,s.jsx)("div",{className:"w-full truncate",children:t.metadata.lastRunBy})]})]})})]},t.id)}))]})}),n&&(0,s.jsx)(m.c,{initialName:"",initialLanguage:v.$v.Stata,initialTopic:"",initialTags:[],initialScheduled:!1,save:function(e,t,a,n,r){return L.apply(this,arguments)},topics:e.ut.topics,cancel:function(){return w(!1)},isNewAnalysis:!0})]})]})}},5301:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(2562)}])},1664:function(e,t,a){e.exports=a(2167)}},function(e){e.O(0,[231,695,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);